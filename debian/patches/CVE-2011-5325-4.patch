From d9503224c8a93a30b0c8627084b2744d3ee6f403 Mon Sep 17 00:00:00 2001
From: Natanael Copa <ncopa@alpinelinux.org>
Date: Fri, 30 Mar 2018 20:18:12 +0200
Subject: cpio: extract "unsafe" symlinks the same way tar/unzip does

function                                             old     new   delta
cpio_main                                            588     596      +8

Signed-off-by: Natanael Copa <ncopa@alpinelinux.org>
Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com>
---
 archival/cpio.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/archival/cpio.c b/archival/cpio.c
index 1d6cbd1..308ec1b 100644
--- a/archival/cpio.c
+++ b/archival/cpio.c
@@ -508,6 +508,8 @@ int cpio_main(int argc UNUSED_PARAM, char **argv)
 	while (get_header_cpio(archive_handle) == EXIT_SUCCESS)
 		continue;
 
+	create_symlinks_from_list(archive_handle->symlink_placeholders);
+
 	if (archive_handle->cpio__blocks != (off_t)-1
 	 && !(opt & OPT_QUIET)
 	) {
-- 
cgit v0.12

